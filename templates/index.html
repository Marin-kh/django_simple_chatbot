<!DOCTYPE html>
<html lang="fa" dir="rtl" class="bg-gray-900 text-white">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>سامانه پرسش از اسناد</title>
    {% load static %}
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Vazirmatn:wght@400;500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="{% static 'css/style.css' %}">
    <style>
        body { font-family: 'Vazirmatn', sans-serif; }
    </style>
</head>
<body class="min-h-screen flex flex-col">

    <!-- هدر -->
    <header class="bg-black bg-opacity-50 backdrop-blur-lg border-b border-purple-800">
        <div class="container mx-auto px-6 py-8 text-center">
            <p class="mt-4 text-xl text-purple-300">با توجه به داکیومنت ها سوال خود را بپرسید و پاسخ دقیق از اسناد را دریافت کنید</p>
        </div>
    </header>

    <!-- بخش اصلی -->
    <main class="flex-1 container mx-auto px-6 py-12 max-w-4xl">
        <div class="bg-black bg-opacity-60 rounded-2xl p-10 neon-glow border border-purple-700">
            <form id="questionForm" class="space-y-8">
                <div>
                    <label class="block text-lg font-medium text-purple-300 mb-3">سوال شما:</label>
                    <input
                        type="text"
                        id="questionInput"
                        placeholder="مثلاً: پردازش زبان طبیعی چیست؟"
                        class="w-full px-6 py-4 rounded-xl bg-gray-900 border border-purple-600 text-white input-glow transition"
                        required
                    >
                </div>

                <button
                    type="submit"
                    class="w-full py-5 rounded-xl bg-gradient-to-r from-purple-600 to-indigo-700 hover:from-purple-700 hover:to-indigo-800 text-xl font-bold neon-glow transition transform hover:scale-105"
                >
                    ارسال سوال
                </button>
            </form>

            <!-- نمایش پاسخ -->
            <div id="answerSection" class="mt-12 hidden">
                <h2 class="text-2xl font-bold text-purple-400 mb-6">پاسخ:</h2>
                <div id="answerBox" class="bg-gray-900 bg-opacity-70 rounded-xl p-8 border border-blue-600 neon-glow text-lg leading-relaxed">
                    در حال دریافت پاسخ...
                </div>
            </div>
        </div>

        <!-- لینک ادمین -->
        <div class="text-center mt-12">
            <a href="/admin" class="text-purple-400 hover:text-purple-300 underline text-lg">
                مدیریت اسناد (ادمین)
            </a>
        </div>
    </main>

    <!-- اسکریپت جاوااسکریپت -->
    <script>
        document.getElementById('questionForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            const question = document.getElementById('questionInput').value.trim();
            if (!question) return;

            const answerBox = document.getElementById('answerBox');
            const answerSection = document.getElementById('answerSection');

            answerBox.textContent = 'در حال پردازش...';
            answerSection.classList.remove('hidden');

            try {
                const response = await fetch(`/answer/?q=${encodeURIComponent(question)}`);
                const data = await response.json();

                if (data.answer) {
                    answerBox.textContent = data.answer;
                } else {
                    answerBox.textContent = 'خطایی رخ داد یا پاسخی یافت نشد.';
                }
            } catch (err) {
                answerBox.textContent = 'خطا در ارتباط با سرور.';
            }
        });
    </script>
</body>
</html>